{% style %}
.rotating-logos-{{ section.id }} {
  padding: 60px 20px;
  background: {{ section.settings.section_bg }};
  overflow: hidden;
  position: relative;
}

/* Track */
.rotating-logos-{{ section.id }} .logos-track {
  display: flex;
  width: fit-content;
  animation: slideLogos {{ section.settings.rotate_duration }}s linear infinite;
  will-change: transform;
}

/* Wrapper */
.rotating-logos-{{ section.id }} .logos-wrapper {
  display: flex;
  gap: 40px;
}

/* IMPORTANT: prevent shrink */
.rotating-logos-{{ section.id }} .logo-item {
  width: {{ section.settings.logo_width }}px;
  height: {{ section.settings.logo_height }}px;
  border-radius: 16px;
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 0 0 auto;
  transition: transform 0.35s ease, box-shadow 0.35s ease;
}

/* Image */
.rotating-logos-{{ section.id }} img {
  max-width: 80%;
  max-height: 80%;
  object-fit: contain;
}

/* Hover */
.rotating-logos-{{ section.id }} .logo-item:hover {
  transform: scale(1.08);
  box-shadow: 0 12px 30px rgba(0,0,0,0.15);
}

/* Pause on hover */
.rotating-logos-{{ section.id }}:hover .logos-track {
  animation-play-state: paused;
}

/* PERFECT LOOP */
@keyframes slideLogos {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-50%);
  }
}
{% endstyle %}

<div class="rotating-logos-{{ section.id }}">
  <div class="logos-track">
    <div class="logos-wrapper">
      {% for block in section.blocks %}
        <a
          href="{{ block.settings.logo_link }}"
          class="logo-item"
          target="_blank"
          {{ block.shopify_attributes }}
        >
          {% if block.settings.logo_image != blank %}
            <img
              src="{{ block.settings.logo_image | image_url: width: 300 }}"
              alt="Marketplace Logo"
              loading="lazy"
            >
          {% endif %}
        </a>
      {% endfor %}

      {%- comment -%}
      Duplicate SAME logos inside SAME wrapper
      This guarantees exact width match
      {%- endcomment -%}

      {% for block in section.blocks %}
        <a
          href="{{ block.settings.logo_link }}"
          class="logo-item"
          target="_blank"
        >
          {% if block.settings.logo_image != blank %}
            <img
              src="{{ block.settings.logo_image | image_url: width: 300 }}"
              alt="Marketplace Logo"
              loading="lazy"
            >
          {% endif %}
        </a>
      {% endfor %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "TSS Rotating Logos",
  "settings": [
    {
      "type": "color",
      "id": "section_bg",
      "label": "Section Background Color",
      "default": "#f7f7f7"
    },
    {
      "type": "range",
      "id": "logo_width",
      "label": "Logo Width (px)",
      "min": 80,
      "max": 220,
      "step": 10,
      "default": 140
    },
    {
      "type": "range",
      "id": "logo_height",
      "label": "Logo Height (px)",
      "min": 80,
      "max": 220,
      "step": 10,
      "default": 140
    },
    {
      "type": "range",
      "id": "rotate_duration",
      "label": "Slider Speed (seconds)",
      "min": 10,
      "max": 60,
      "step": 2,
      "default": 30
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Logo Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "logo_image",
          "label": "Logo Image"
        },
        {
          "type": "url",
          "id": "logo_link",
          "label": "Logo Link"
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "TSS Rotating Logos",
      "blocks": [
        { "type": "logo" },
        { "type": "logo" },
        { "type": "logo" }
      ]
    }
  ]
}
{% endschema %}
