{% style %}
.tss-3d-hero-{{ section.id }} {
  position: relative;
  height: {{ section.settings.height-controler }}px;
  padding-top: {{ section.settings.padding_top }}px;
  padding-bottom: {{ section.settings.padding_bottom }}px;
  background-color: {{ section.settings.background_color }};
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Background */
.tss-bg {
  position: absolute;
  inset: 0;
  z-index: 0;
}

.tss-bg img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: opacity .4s ease;
}

/* Overlay */
.tss-bg::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,{{ section.settings.overlay_opacity | divided_by: 100.0 }});
  opacity: {% if section.settings.enable_overlay %}1{% else %}0{% endif %};
}

/* Layout */
.tss-inner {
  position: relative;
  z-index: 2;
  width: 100%;
  max-width: 1400px;
  display: grid;
  grid-template-columns: 120px auto 120px;
  align-items: center;
  justify-content: center;
}

/* Titles */
.tss-title {
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 40px;
  text-align: center;
  align-items: center;
}

.tss-title h1 {
  font-size: clamp(48px, 10vw, 140px);
  font-weight: 900;
  line-height: .9;
  text-transform: uppercase;
  color: #ffb000;
}

/* Side thumbnails */
.tss-side {
  display: flex;
  flex-direction: column;
  gap: 20px;
  align-items: center;
}

.tss-side img {
  width: 80px;
  cursor: pointer;
  opacity: .6;
  filter: grayscale(1);
  transition: all .4s ease;
}

.tss-side img:hover {
  opacity: 1;
  filter: none;
  transform: scale(1.1);
}

/* Center */
.tss-center {
  text-align: center;
  perspective: 1200px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.tss-center img {
  max-width: 100%;
  max-height: 580px;
  width: auto;
  height: auto;
  object-fit: contain;
  transform-style: preserve-3d;
  animation: tssFloat 4s ease-in-out infinite;
  transition: transform .4s ease;
}

/* Button */
.tss-btn {
  margin-top: 30px;
  display: inline-block;
  padding: 14px 40px;
  border-radius: 40px;
  background: #000;
  color: #fff;
  text-decoration: none;
  font-weight: 600;
  transition: transform .3s ease;
}

.tss-btn:hover {
  transform: translateY(-3px);
}

/* 3D Animation */
@keyframes tssFloat {
  0%,100% { transform: translateY(0) rotateY(0deg); }
  50% { transform: translateY(-18px) rotateY(8deg); }
}

/* Mobile */
@media(max-width: 768px) {
  .tss-inner {
    grid-template-columns: 1fr;
    gap: 30px;
  }

  .tss-side {
    flex-direction: row;
    justify-content: center;
  }

  .tss-center img {
    max-height: 380px;
  }
}
{% endstyle %}

<section class="tss-3d-hero-{{ section.id }}" data-hero>

  <div class="tss-bg">
    <img 
      src="{{ section.blocks.first.settings.bg | image_url: width: 2400 }}"
      data-desktop-bg="{{ section.blocks.first.settings.bg | image_url: width: 2400 }}"
      data-mobile-bg="{% if section.blocks.first.settings.mobile_bg != blank %}{{ section.blocks.first.settings.mobile_bg | image_url: width: 1200 }}{% endif %}"
      data-bg
    >
  </div>

  <div class="tss-title">
    <h1 data-heading>{{ section.blocks.first.settings.heading }}</h1>
    <h1 data-subheading>{{ section.blocks.first.settings.subheading }}</h1>
  </div>

  <div class="tss-inner">

    <div class="tss-side">
      {% for block in section.blocks %}
        <img
          src="{{ block.settings.product | image_url: width: 300 }}"
          data-product="{{ block.settings.product | image_url: width: 900 }}"
          data-desktop-bg="{{ block.settings.bg | image_url: width: 2400 }}"
          data-mobile-bg="{% if block.settings.mobile_bg != blank %}{{ block.settings.mobile_bg | image_url: width: 1200 }}{% endif %}"
          data-heading="{{ block.settings.heading | escape }}"
          data-subheading="{{ block.settings.subheading | escape }}"
          data-btn-text="{{ block.settings.button_text | escape }}"
          data-btn-link="{{ block.settings.button_link }}"
          data-btn-show="{{ block.settings.show_button }}"
        >
      {% endfor %}
    </div>

    <div class="tss-center">
      <img src="{{ section.blocks.first.settings.product | image_url: width: 900 }}" data-main>
      <div data-btn-wrap>
        {% if section.blocks.first.settings.show_button %}
          <a href="{{ section.blocks.first.settings.button_link }}" class="tss-btn">
            {{ section.blocks.first.settings.button_text }}
          </a>
        {% endif %}
      </div>
    </div>

    <div class="tss-side">
      {% for block in section.blocks %}
        <img
          src="{{ block.settings.product | image_url: width: 300 }}"
          data-product="{{ block.settings.product | image_url: width: 900 }}"
          data-desktop-bg="{{ block.settings.bg | image_url: width: 2400 }}"
          data-mobile-bg="{% if block.settings.mobile_bg != blank %}{{ block.settings.mobile_bg | image_url: width: 1200 }}{% endif %}"
          data-heading="{{ block.settings.heading | escape }}"
          data-subheading="{{ block.settings.subheading | escape }}"
          data-btn-text="{{ block.settings.button_text | escape }}"
          data-btn-link="{{ block.settings.button_link }}"
          data-btn-show="{{ block.settings.show_button }}"
        >
      {% endfor %}
    </div>

  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('[data-hero]').forEach(hero => {

    const main = hero.querySelector('[data-main]');
    const bg = hero.querySelector('[data-bg]');
    const h1 = hero.querySelector('[data-heading]');
    const h2 = hero.querySelector('[data-subheading]');
    const btnWrap = hero.querySelector('[data-btn-wrap]');

    function setInitialBg() {
      const isMobile = window.innerWidth <= 768;
      bg.src = isMobile && bg.dataset.mobileBg
        ? bg.dataset.mobileBg
        : bg.dataset.desktopBg;
    }

    setInitialBg();
    window.addEventListener('resize', setInitialBg);

    hero.querySelectorAll('.tss-side img').forEach(img => {
      img.addEventListener('click', () => {

        const isMobile = window.innerWidth <= 768;
        bg.src = isMobile && img.dataset.mobileBg
          ? img.dataset.mobileBg
          : img.dataset.desktopBg;

        h1.textContent = img.dataset.heading;
        h2.textContent = img.dataset.subheading;

        btnWrap.innerHTML = '';
        if (img.dataset.btnShow === 'true' && img.dataset.btnLink) {
          btnWrap.innerHTML =
            `<a href="${img.dataset.btnLink}" class="tss-btn">${img.dataset.btnText}</a>`;
        }

        main.style.transform = 'rotateY(90deg) scale(.85)';
        setTimeout(() => {
          main.src = img.dataset.product;
          main.style.transform = 'rotateY(0deg) scale(1)';
        }, 400);
      });
    });

  });
});
</script>

{% schema %}
{
  "name": "TSS 3D Showcase",
  "settings": [
    { "type": "checkbox", "id": "enable_overlay", "label": "Enable Background Overlay", "default": true },
    { "type": "range", "id": "overlay_opacity", "label": "Overlay Opacity", "min": 0, "max": 90, "step": 5, "default": 40 },
    {"type": "color", "id": "background_color", "label": "Background Color", "default": "#000000"},
    {
  "type": "range",
  "id": "height-controler",
  "label": "Height Control",
  "min": 300,
  "max": 800,
  "step": 10,
  "default": 580
},
{
  "type": "range",
  "id": "padding_top",
  "label": "Padding Top",
  "min": 0,
  "max": 200,
  "step": 5,
  "default": 60
},
{
  "type": "range",
  "id": "padding_bottom",
  "label": "Padding Bottom",
  "min": 0,
  "max": 200,
  "step": 5,
  "default": 60
}
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product Slide",
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "MANGO CHILLI" },
        { "type": "text", "id": "subheading", "label": "Subheading", "default": "MS. AAMBUSH" },
        { "type": "image_picker", "id": "product", "label": "Product Image" },
        { "type": "image_picker", "id": "bg", "label": "Background Image" },
        { "type": "image_picker", "id": "mobile_bg", "label": "Mobile Background Image" },
        { "type": "checkbox", "id": "show_button", "label": "Show Buy Now Button", "default": true },
        { "type": "text", "id": "button_text", "label": "Button Text", "default": "Buy Now" },
        { "type": "url", "id": "button_link", "label": "Button Link" },
       
      ]
    }
  ],
  "presets": [
    { "name": "TSS 3D Showcase" }
  ]
}
{% endschema %}
