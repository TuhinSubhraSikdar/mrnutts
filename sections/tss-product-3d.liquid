{% style %}
.tss-3d-hero-{{ section.id }} {
  position: relative;
  height: 100vh;
  overflow: hidden;
  background: #fdecc2;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Background */
.tss-bg {
  position: absolute;
  inset: 0;
  z-index: 0;
}

.tss-bg img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Overlay (SECTION CONTROLLED) */
.tss-bg::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,{{ section.settings.overlay_opacity | divided_by: 100.0 }});
  opacity: {% if section.settings.enable_overlay %}1{% else %}0{% endif %};
  transition: opacity .3s ease;
}

/* Layout */
.tss-inner {
  position: relative;
  z-index: 2;
  width: 100%;
  max-width: 1400px;
  display: grid;
  grid-template-columns: 120px 1fr 120px;
  align-items: center;
  padding: 40px;
}

/* Headings */
.tss-title {
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 40px;
}

.tss-title h1 {
  font-size: clamp(48px, 10vw, 140px);
  font-weight: 900;
  line-height: .9;
  text-transform: uppercase;
  color: #ffb000;
}

/* Side thumbnails */
.tss-side {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.tss-side img {
  width: 80px;
  cursor: pointer;
  opacity: .6;
  filter: grayscale(1);
  transition: all .4s ease;
}

.tss-side img:hover {
  opacity: 1;
  filter: none;
  transform: scale(1.1);
}

/* Center product */
.tss-center {
  text-align: center;
  perspective: 1200px;
}

.tss-center img {
  max-height: 520px;
  transform-style: preserve-3d;
  animation: tssFloat 4s ease-in-out infinite;
}

/* Button */
.tss-btn {
  margin-top: 30px;
  display: inline-block;
  padding: 14px 40px;
  border-radius: 40px;
  background: #000;
  color: #fff;
  text-decoration: none;
  font-weight: 600;
  transition: transform .3s ease;
}

.tss-btn:hover {
  transform: translateY(-3px);
}

/* Animation */
@keyframes tssFloat {
  0%,100% { transform: translateY(0) rotateY(-12deg); }
  50% { transform: translateY(-18px) rotateY(12deg); }
}

/* Mobile */
@media(max-width: 768px) {
  .tss-inner {
    grid-template-columns: 1fr;
    gap: 30px;
  }

  .tss-side {
    flex-direction: row;
    justify-content: center;
  }

  .tss-center img {
    max-height: 320px;
  }
}
{% endstyle %}

<section class="tss-3d-hero-{{ section.id }}" data-hero>

  <!-- Background -->
  <div class="tss-bg">
    <img src="{{ section.blocks.first.settings.bg | image_url: width: 2400 }}" data-bg>
  </div>

  <!-- Titles -->
  <div class="tss-title">
    <h1 data-heading>{{ section.blocks.first.settings.heading }}</h1>
    <h1 data-subheading>{{ section.blocks.first.settings.subheading }}</h1>
  </div>

  <div class="tss-inner">

    <!-- Left thumbs -->
    <div class="tss-side">
      {% for block in section.blocks %}
        <img
          src="{{ block.settings.product | image_url: width: 300 }}"
          data-product="{{ block.settings.product | image_url: width: 900 }}"
          data-bg="{{ block.settings.bg | image_url: width: 2400 }}"
          data-heading="{{ block.settings.heading | escape }}"
          data-subheading="{{ block.settings.subheading | escape }}"
          data-btn-text="{{ block.settings.button_text | escape }}"
          data-btn-link="{{ block.settings.button_link }}"
          data-btn-show="{{ block.settings.show_button }}"
        >
      {% endfor %}
    </div>

    <!-- Center -->
    <div class="tss-center">
      <img src="{{ section.blocks.first.settings.product | image_url: width: 900 }}" data-main>

      <div data-btn-wrap>
        {% if section.blocks.first.settings.show_button %}
          <a href="{{ section.blocks.first.settings.button_link }}" class="tss-btn" data-btn>
            {{ section.blocks.first.settings.button_text }}
          </a>
        {% endif %}
      </div>
    </div>

    <!-- Right thumbs -->
    <div class="tss-side">
      {% for block in section.blocks %}
        <img
          src="{{ block.settings.product | image_url: width: 300 }}"
          data-product="{{ block.settings.product | image_url: width: 900 }}"
          data-bg="{{ block.settings.bg | image_url: width: 2400 }}"
          data-heading="{{ block.settings.heading | escape }}"
          data-subheading="{{ block.settings.subheading | escape }}"
          data-btn-text="{{ block.settings.button_text | escape }}"
          data-btn-link="{{ block.settings.button_link }}"
          data-btn-show="{{ block.settings.show_button }}"
        >
      {% endfor %}
    </div>

  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('[data-hero]').forEach(hero => {
    const main = hero.querySelector('[data-main]');
    const bg = hero.querySelector('[data-bg]');
    const h1 = hero.querySelector('[data-heading]');
    const h2 = hero.querySelector('[data-subheading]');
    const btnWrap = hero.querySelector('[data-btn-wrap]');

    hero.querySelectorAll('.tss-side img').forEach(img => {
      img.addEventListener('click', () => {

        bg.src = img.dataset.bg;
        h1.textContent = img.dataset.heading;
        h2.textContent = img.dataset.subheading;

        btnWrap.innerHTML = '';
        if (img.dataset.btnShow === 'true' && img.dataset.btnLink) {
          btnWrap.innerHTML =
            `<a href="${img.dataset.btnLink}" class="tss-btn">${img.dataset.btnText}</a>`;
        }

        main.style.transform = 'rotateY(90deg) scale(.85)';
        setTimeout(() => {
          main.src = img.dataset.product;
          main.style.transform = 'rotateY(-12deg) scale(1)';
        }, 400);
      });
    });
  });
});
</script>

{% schema %}
{
  "name": "TSS 3D Product Showcase",
  "settings": [
    { "type": "checkbox", "id": "enable_overlay", "label": "Enable Background Overlay", "default": true },
    { "type": "range", "id": "overlay_opacity", "label": "Overlay Opacity", "min": 0, "max": 90, "step": 5, "default": 40 }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product Slide",
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "MANGO CHILLI" },
        { "type": "text", "id": "subheading", "label": "Subheading", "default": "MS. AAMBUSH" },
        { "type": "image_picker", "id": "product", "label": "Product Image" },
        { "type": "image_picker", "id": "bg", "label": "Background Image" },
        { "type": "checkbox", "id": "show_button", "label": "Show Buy Now Button", "default": true },
        { "type": "text", "id": "button_text", "label": "Button Text", "default": "Buy Now" },
        { "type": "url", "id": "button_link", "label": "Button Link" }
      ]
    }
  ],
  "presets": [
    { "name": "TSS 3D Product Showcase" }
  ]
}
{% endschema %}
